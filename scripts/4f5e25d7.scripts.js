!function(){angular.module("quizApp",["ng-firebase","ng-firebase-simple-login"]).constant("FIREBASE_URL","https://angular-quiz.firebaseio.com/").config(["$routeProvider",function(a){var b;return b=function(a){return a.requestCurrentUser()},b.$inject=["Auth"],a.when("/",{templateUrl:"views/quiz.html",controller:"QuizCtrl",resolve:{currentUser:b}}).when("/login",{templateUrl:"views/login.html",controller:"LogInCtrl"}).when("/signup",{templateUrl:"views/signup.html",controller:"SignUpCtrl"}).otherwise({redirectTo:"/"})}])}.call(this),function(){angular.module("ng-firebase-simple-login",["ng-firebase"]).value("FirebaseSimpleLogin",FirebaseSimpleLogin)}.call(this),function(){angular.module("quizApp").factory("safeApply",["$rootScope",function(a){var b;return b=function(b){var c;return c=a.$$phase,"$apply"===c||"$digest"===c?b():a.$apply(b)}}])}.call(this),function(){angular.module("quizApp").factory("Flash",["$rootScope",function(a){var b,c,d,e;return d=a.flash={},c={},a.$on("$routeChangeSuccess",function(){var a,b,e,f;for(f=["errors","successes"],b=0,e=f.length;e>b;b++)a=f[b],d[a]=c[a],c[a]=[];return null}),b=function(a){var b;return b={reset:function(){return a.errors=[],a.successes=[],b},error:function(b){return a.errors.push(b)},success:function(b){return a.successes.push(b)}},b.reset()},e={now:b(d),future:b(c)}}])}.call(this),function(){angular.module("quizApp").factory("FirebaseDatabaseConnection",["Firebase","FIREBASE_URL",function(a,b){return new a(b)}]).factory("DB",["FirebaseDatabaseConnection","safeApply","$q","$log",function(a,b,c,d){var e,f;return e=a,f={read:function(a){var f;return f=c.defer(),e.child(a).on("value",function(c){var e;return e=c.val(),d.log("db: loaded "+a+" "+e),b(function(){return f.resolve(e)})}),f.promise},write:function(a,d){var f,g;return f=c.defer(),g=e.child(a),g.set(d,function(a){return b(function(){return a?f.reject(a):f.resolve(!0)})}),f.promise}}}])}.call(this),function(){angular.module("quizApp").factory("Quiz",["DB","$q",function(a,b){var c,d,e;return c=null,e={},d={loadQuestions:function(){return a.read("questions")},loadAnswers:function(){return c?b.when(c):a.read("answers").then(function(a){return c=a})},loadResponse:function(c){return e[c]?b.when(e[c]):a.read("responses/"+c).then(function(a){return e[c]=a})},submitResponse:function(b,c){return a.write("responses/"+b,c)}}}])}.call(this),function(){angular.module("quizApp").factory("CredentialsValidator",function(){var a;return a={validate:function(a,b){var c;return c=!0,a.email||(b("Invalid email"),c=!1),a.password||(b("Invalid password"),c=!1),c}}})}.call(this),function(){angular.module("quizApp").factory("FirebaseSimpleAuth",["FirebaseDatabaseConnection","FirebaseSimpleLogin","$rootScope","$q","safeApply","$log",function(a,b,c,d,e,f){var g,h,i,j;return h=null,i=d.defer(),g=new b(a,function(a,b){return c.$broadcast("authStatusChanged",b),e(function(){if(a){if(f.error("FirebaseSimpleAuth: "+a),i)return i.reject(a)}else{if(!b)return f.info("FirebaseSimpleAuth: User not authenticated!!!"),h=null,i&&i.reject({reason:"ACCESS_DENIED"}),i=null;if(f.info("FirebaseSimpleAuth: User logged in! User Id: "+b.id+", Email: "+b.email),h=b,i)return i.resolve(b)}})}),j={signup:function(a,b){var c;return c=d.defer(),g.createUser(a,b,function(a,b){return e(function(){return a?c.reject(a):c.resolve(b)})}),c.promise},login:function(a,b){return g.login("password",{email:a,password:b}),i=d.defer(),i.promise},requestCurrentUser:function(){var a;return h?d.when(h):i?i.promise:(a=d.defer(),a.reject({reason:"ACCESS_DENIED"}),a.promise)},logout:function(){return g.logout()}}}])}.call(this),function(){angular.module("quizApp").factory("Auth",["FirebaseSimpleAuth",function(a){return a}])}.call(this),function(){angular.module("quizApp").directive("quiz",function(){return{restrict:"E",replace:!0,transclude:!0,controller:["$scope",function(a){var b;return a.quiz||(a.quiz={}),(b=a.quiz).response||(b.response={}),this}],template:"<div class='quiz' ng-transclude></div>"}}).directive("question",function(){return{restrict:"E",replace:!0,transclude:!0,controller:["$scope","$attrs",function(a,b){var c,d;return this.name=b.name,(c=a.quiz.response)[d=this.name]||(c[d]={}),this}],scope:!0,template:'<fieldset class="question" ng-transclude ng-class="{invalid: quiz.correct[name].invalid}">\n</fieldset>',link:function(a,b,c){return a.name=c.name}}}).directive("choice",function(){return{restrict:"A",replace:!1,transclude:!0,require:"^question",scope:!0,template:'<label class="checkbox"\n   ng-class="{correct: quiz.correct[questionName].answers[answerName].correctValue,\n              invalid: quiz.correct[questionName].answers[answerName].invalid}">\n  <input type="checkbox" ng-disabled="quiz.disabled" ng-model="quiz.response[questionName][answerName]">\n  <span ng-transclude></span>\n</label>',link:function(a,b,c,d){return a.questionName=d.name,a.answerName=c.value}}}).directive("inlineAnswer",function(){return{restrict:"E",replace:!0,transclude:!1,require:"^question",scope:!0,template:'<input class="inline-answer" type="text" ng-disabled="quiz.disabled"\n  ng-class="{invalid: quiz.correct[questionName].answers[answerName].invalid}"\n  ng-model="quiz.response[questionName][answerName]">',link:function(a,b,c,d){return a.questionName=d.name,a.answerName=c.name,a.$watch("quiz.correct[questionName].answers[answerName].correctValue",function(a){return c.$set("title",a&&"Correct answer: "+a||"")})}}})}.call(this),function(){angular.module("quizApp").controller("AppCtrl",["$scope","$location","Auth","Flash",function(a,b,c,d){return a.$on("authStatusChanged",function(b,c){return a.currentUser=c}),a.$on("$routeChangeError",function(a,c,e,f){return d.future.error("You must be logged in to access this page"),"ACCESS_DENIED"===f.reason?b.path("/login"):void 0}),a.logout=function(){return c.logout(),b.path("/login")}}])}.call(this),function(){angular.module("quizApp").controller("SignUpCtrl",["$scope","$location","Auth","Flash","CredentialsValidator",function(a,b,c,d,e){var f;return f=function(a){return d.now.error(a)},a.signup=function(){var g,h;return e.validate(a,f)?(a.processing=!0,h=function(){return d.future.success("You've been signed up! Now you can log in."),b.path("/login")},g=function(b){return d.now.error(b.message||b),a.processing=!1},c.signup(a.email,a.password).then(h,g)):void 0}}])}.call(this),function(){angular.module("quizApp").controller("LogInCtrl",["$scope","$location","Auth","Flash","CredentialsValidator",function(a,b,c,d,e){var f;return f=function(a){return d.now.error(a)},a.login=function(){var g,h;return d.now.reset(),e.validate(a,f)?(a.processing=!0,h=function(){return d.future.success("Welcome!"),b.path("/")},g=function(b){return d.now.error(b.message||b),a.processing=!1},c.login(a.email,a.password).then(h,g)):void 0}}])}.call(this),function(){var a={}.hasOwnProperty;angular.module("quizApp").controller("QuizCtrl",["$scope","currentUser","Quiz","Flash",function(b,c,d,e){var f;return f=b.quiz||(b.quiz={}),b.status="Loading questions. Please wait...",d.loadResponse(c.id).then(function(a){return null!=a&&(f.response=a,f.disabled=!0),b.status=null,f.ready=!0}),b.submitResponse=function(){var a,g;return b.processing=!0,e.now.reset(),g=function(){return e.now.success("Thanks for submitting the response!"),f.disabled=!0},a=function(a){return e.now.error("Failed to save the response: "+a)},d.submitResponse(c.id,f.response).then(g,a),null},b.showCorrectAnswers=function(){return f.correct={},d.loadAnswers().then(function(b){var c,d,e,g,h,i,j,k,l;k=f.response;for(i in k)if(a.call(k,i)){e=k[i],j=f.correct[i]={answers:{}},l=b[i];for(c in l)a.call(l,c)&&(h=l[c],d=e[c],g=h?h===d:!!h==!!d,g||(j.invalid=!0),j.answers[c]={correct:g,correctValue:h,invalid:d&&!g})}return null}),null}}])}.call(this);