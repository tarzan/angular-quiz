!function(){angular.module("quizApp",["ng-firebase","ng-firebase-simple-login"]).config(["$routeProvider",function(a){var b;return b=function(a){return a.requestCurrentUser()},b.$inject=["Auth"],a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",resolve:{currentUser:b}}).when("/login",{templateUrl:"views/login.html",controller:"LogInCtrl"}).when("/signup",{templateUrl:"views/signup.html",controller:"SignUpCtrl"}).otherwise({redirectTo:"/"})}]).constant("FIREBASE_URL","https://angular-quiz.firebaseio.com/")}.call(this),function(){angular.module("ng-firebase-simple-login",["ng-firebase"]).value("FirebaseSimpleLogin",FirebaseSimpleLogin)}.call(this),function(){angular.module("quizApp").factory("safeApply",["$rootScope",function(a){var b;return b=function(b){var c;return c=a.$$phase,"$apply"===c||"$digest"===c?b():a.$apply(b)}}])}.call(this),function(){angular.module("quizApp").factory("Flash",["$rootScope",function(a){var b,c,d,e;return d=a.flash={},c={},a.$on("$routeChangeSuccess",function(){var a,b,e,f;for(f=["errors","successes"],b=0,e=f.length;e>b;b++)a=f[b],d[a]=c[a],c[a]=[];return null}),b=function(a){var b;return b={reset:function(){return a.errors=[],a.successes=[],b},error:function(b){return a.errors.push(b)},success:function(b){return a.successes.push(b)}},b.reset()},e={now:b(d),future:b(c)}}])}.call(this),function(){angular.module("quizApp").factory("FirebaseDatabaseConnection",["Firebase","FIREBASE_URL",function(a,b){return new a(b)}]).factory("DB",["FirebaseDatabaseConnection","safeApply","$q","$log",function(a,b,c,d){var e,f;return e=a,f={read:function(a){var f;return f=c.defer(),e.child(a).on("value",function(c){var e;return e=c.val(),d.log("db: loaded "+a+" "+e),b(function(){return f.resolve(e)})}),f.promise},write:function(a,d){var f,g;return f=c.defer(),g=e.child(a),g.set(d,function(a){return b(function(){return a?f.reject(a):f.resolve(!0)})}),f.promise}}}])}.call(this),function(){angular.module("quizApp").factory("Quiz",["DB","$q",function(a,b){var c,d,e;return c=null,e={},d={loadQuestions:function(){return a.read("questions")},loadAnswers:function(){return c?b.when(c):a.read("answers").then(function(a){return c=a})},loadResponse:function(c){return e[c]?b.when(e[c]):a.read("responses/"+c).then(function(a){return e[c]=a})},submitResponse:function(b,c){return a.write("responses/"+b,c)}}}])}.call(this),function(){angular.module("quizApp").factory("CredentialsValidator",function(){var a;return a={validate:function(a,b){var c;return c=!0,a.email||(b("Invalid email"),c=!1),a.password||(b("Invalid password"),c=!1),c}}})}.call(this),function(){angular.module("quizApp").factory("FirebaseSimpleAuth",["FirebaseDatabaseConnection","FirebaseSimpleLogin","$rootScope","$q","safeApply","$log",function(a,b,c,d,e,f){var g,h,i,j;return i=d.defer(),h=null,g=new b(a,function(a,b){return c.$broadcast("authStatusChanged",b),e(function(){if(a){if(f.error("FirebaseSimpleAuth: "+a),i)return i.reject(a)}else{if(!b)return f.info("FirebaseSimpleAuth: User not authenticated!!!"),h=null,i&&i.reject({reason:"ACCESS_DENIED"}),i=null;if(f.info("FirebaseSimpleAuth: User logged in! User Id: "+b.id+", Email: "+b.email),h=b,i)return i.resolve(b)}})}),j={signup:function(a,b){var c;return c=d.defer(),g.createUser(a,b,function(a,b){return e(function(){return a?c.reject(a):c.resolve(b)})}),c.promise},login:function(a,b){return g.login("password",{email:a,password:b}),i=d.defer(),i.promise},requestCurrentUser:function(){var a;return h?d.when(h):i?i.promise:(a=d.defer(),a.reject({reason:"ACCESS_DENIED"}),a.promise)},logout:function(){return g.logout()}}}])}.call(this),function(){angular.module("quizApp").factory("Auth",["FirebaseSimpleAuth",function(a){return a}])}.call(this),function(){angular.module("quizApp").controller("AppCtrl",["$scope","$location","Auth","Flash",function(a,b,c,d){return a.$on("authStatusChanged",function(b,c){return a.currentUser=c}),a.$on("$routeChangeError",function(a,c,e,f){return d.future.error("You must be logged in to access this page"),"ACCESS_DENIED"===f.reason?b.path("/login"):void 0}),a.logout=function(){return c.logout(),b.path("/login")}}])}.call(this),function(){angular.module("quizApp").controller("MainCtrl",["$scope","currentUser","Quiz","Flash","$q","$log",function(a,b,c,d,e,f){var g;return a.disabled=!1,a.questions=!1,a.status="Loading questions. Please wait...",g=[],g.push(c.loadQuestions().then(function(b){return a.questions=b})),g.push(c.loadResponse(b.id).then(function(b){return a.response=b,a.disabled=null!==b})),e.all(g).then(function(){var b,c,d,e,f,g,h,i,j,k;if(e=a.response)for(j=a.questions,f=0,h=j.length;h>f;f++)if(c=j[f],d=e[c.name])for(k=c.options,g=0,i=k.length;i>g;g++)b=k[g],b.checked=d[b.value];return null}).then(function(){return a.status=null}),a.showCorrectAnswers=function(){return c.loadAnswers().then(function(b){var c,d,e,f,g,h,i,j,k;for(j=a.questions,f=0,h=j.length;h>f;f++)if(e=j[f],c=b[e.name])for(k=e.options,g=0,i=k.length;i>g;g++)d=k[g],d.correct=c[d.value],d.checked&&!d.correct&&(d.invalid=!0),!!d.checked!==d.correct&&(e.invalid=!0);return a})},a.submitResponse=function(){var e,g,h,i,j,k,l,m,n;for(a.processing=!0,d.now.reset(),h={},m=a.questions,i=0,k=m.length;k>i;i++)for(g=m[i],h[g.name]={},n=g.options,j=0,l=n.length;l>j;j++)e=n[j],h[g.name][e.value]=e.checked||!1;return c.submitResponse(b.id,h).then(function(){return d.now.success("Thanks for submitting the response!"),a.response=h,a.disabled=!0},function(a){return d.now.error("Failed to save the response: "+a),f.error(a)}),a}}])}.call(this),function(){angular.module("quizApp").controller("SignUpCtrl",["$scope","$location","Auth","Flash","CredentialsValidator",function(a,b,c,d,e){var f;return f=function(a){return d.now.error(a)},a.signup=function(){var g,h;return e.validate(a,f)?(a.processing=!0,h=function(){return d.future.success("You've been signed up! Now you can log in."),b.path("/login")},g=function(b){return d.now.error(b.message||b),a.processing=!1},c.signup(a.email,a.password).then(h,g)):void 0}}])}.call(this),function(){angular.module("quizApp").controller("LogInCtrl",["$scope","$location","Auth","Flash","CredentialsValidator",function(a,b,c,d,e){var f;return f=function(a){return d.now.error(a)},a.login=function(){var g,h;return d.now.reset(),e.validate(a,f)?(a.processing=!0,h=function(){return d.future.success("Welcome!"),b.path("/")},g=function(b){return d.now.error(b.message||b),a.processing=!1},c.login(a.email,a.password).then(h,g)):void 0}}])}.call(this);